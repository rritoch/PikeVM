<html><head><title>Pike Reference Manual - GSSAPI.Context()-&gt;wrap()</title>
<link rel='stylesheet' href='../../../../style.css' /></head>
<body topmargin='0' leftmargin='0' marginheight='0' marginwidth='0'
      bgcolor='#ffffff' text='#000000' link='#000099' alink='#002040'
      vlink='#000099'>

<table width="100%">
  <tr>
    <td colspan='3'></td>
    <td colspan='2' align='right'>Extracted from Pike v7.8 release 116 at 2008-12-31.</td>
  </tr>
  <tr>
    <td width="0%"><img src="../../../..//images/unit.gif" alt="" width="10" height="1"></td>
    <td width="1%">
      <a href="http://pike.ida.liu.se/"><img src="../../../..//images/pike_logo.gif"
      border="0" alt="pike.ida.liu.se" width="181" height="41" hspace="5"></a></td>
    <td width="0%"><img src="../../../..//images/unit.gif" alt="" width="10" height="1"></td>
    <td width="99%">
      <table align="center" border="0" width="100%" cellspacing="0" cellpadding="0" valign="middle">
        <tr>
          <td width="1%" align="right"><img src="../../../..//images/pike_line_left.gif" alt="" border="0" width="5" height="11"></td>
          <td background="../../../..//images/pike_line_middle.gif" width="98%"><img src="../../../..//images/unit.gif" alt="" border="0" width="11" height="11"></td>
          <td width="1%" align="left"><img src="../../../..//images/pike_line_right.gif" alt="" border="0" width="5" height="11"></td>
        </tr>
      </table>
    </td>
    <td width="0%"><img src="../../../..//images/unit.gif" alt="" width="10" height="1"></td>
  </tr>
  <tr>
    <td colspan="5"><img src="../../../..//images/unit.gif" alt="" width="1" height="10"></td>
  </tr>
</table>

<table>
  <tr>
    <td width='180' valign='top' bgcolor='#f0f0f0'><a href='../../../../index.html'><b>[Top]</b></a><br />
<a href='../../../../ex/predef_3A_3A/GSSAPI.html'><b>GSSAPI</b></a><br />
<a href='../../../../ex/predef_3A_3A/GSSAPI/Context.html'><b>GSSAPI.Context</b></a><br />
<table border='0' cellpadding='1' cellspacing='0' class='sidebar'><tr><td nowrap='nowrap'><br /><b>Methods</b></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/create.html'>create()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/delete.html'>delete()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/export.html'>export()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/get_mic.html'>get_mic()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/is_established.html'>is_established()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/last_confidential.html'>last_confidential()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/last_major_status.html'>last_major_status()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/last_minor_status.html'>last_minor_status()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/last_qop.html'>last_qop()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/lifetime.html'>lifetime()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/locally_initiated.html'>locally_initiated()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/mech.html'>mech()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/process_token.html'>process_token()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/required_services.html'>required_services()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/services.html'>services()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/source_name.html'>source_name()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/target_name.html'>target_name()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/unwrap.html'>unwrap()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/verify_mic.html'>verify_mic()</a></td></tr>
<tr><td nowrap='nowrap'>&nbsp;wrap()</td></tr>
<tr><td nowrap='nowrap'>&nbsp;<a href='../../../../ex/predef_3A_3A/GSSAPI/Context/wrap_size_limit.html'>wrap_size_limit()</a></td></tr>
</table></td>
    <td width='520' valign='top'>

    <table border="0" width="520" bgcolor="#e0e0e0"
           cellpadding="0" cellspacing="4" class='sidebar'>
      <tr>
        <td valign="middle">
	  <a href="../../../../ex/predef_3A_3A/GSSAPI/Context/verify_mic.html"><img src="../../../../images/prev.gif" hspace="3"
	         border="0" alt="previous" >GSSAPI.Context()-&gt;verify_mic()</a>
          <br />
	</td>
	<td align="right" valign="middle">
	  <a href="../../../../ex/predef_3A_3A/GSSAPI/Context/wrap_size_limit.html">GSSAPI.Context()-&gt;wrap_size_limit()<img src="../../../../images/next.gif" hspace="3"
	          border="0" alt="next" ></a>
	  <br />
	</td>
      </tr>
    </table>

    <h1>Method GSSAPI.Context()-&gt;wrap()</h1>
    

<hr clear='all' size='1' noshadow='noshadow' />
<dl>
<dt><font face='Helvetica'><font face='Helvetica'>Method</font>
<font size='+1'><b>wrap</b></font>
</font><dt>
<dd><p><tt><font color='#202020'>string</font> <b><font color='#000066'>wrap</font>(</b><font color='#202020'>string</font> <font color='#005080'>message</font>, <font color='#202020'>void</font>|<font color='#202020'>int</font> <font color='#005080'>encrypt</font>, <font color='#202020'>void</font>|<font color='#202020'>int</font> <font color='#005080'>qop</font><b>)</b></tt></p></dd>

<dt><font face='Helvetica'>Description</font><dt>
<dd><font face='Helvetica'><p>Calculates a MIC (message integrity checksum) for the given
 message, and returns it together with the message, which is
 optionally encrypted. The returned value can be verified and (if
 applicable) decrypted by the receiver using <font face='courier'><a href='../../../predef_3A_3A/GSSAPI/Context/unwrap.html'>unwrap</a></font>  or some
 other <tt>GSS_Unwrap</tt> wrapper.</p>
<p> This wraps <tt>GSS_Wrap</tt> according to RFC 2743 section 2.3.3.</p>
<p> This function requires that the context is established, or that
 the early per-message protection service is available (c.f.
 <font face='courier'>GSSAPI.PROT_READY_FLAG</font> . If not, a
 <font face='courier'><a href='../../../predef_3A_3A/GSSAPI/MissingServicesError.html'>GSSAPI.MissingServicesError</a></font>  is thrown (but the context is not
 closed).</p>
</font></dd>
<dt><font face='Helvetica'>Parameter <tt><font color='#8000F0'>message</font></tt></font><dt>
<dd></dd><dd><font face='Helvetica'><p>The message to be wrapped. It may be of zero length.</p>
</font></dd>
<dt><font face='Helvetica'>Parameter <tt><font color='#8000F0'>encrypt</font></tt></font><dt>
<dd></dd><dd><font face='Helvetica'><p>Set to nonzero to request that the message is encrypted.
   Otherwise only a MIC is calculated and the returned value
   contains the unencrypted message.</p>
<p>   If this is set and the confidentiality service (c.f.
   <font face='courier'>GSSAPI.CONF_FLAG</font> ) is required then the returned value is
   always encrypted. Otherwise it might not be encrypted anyway,
   and a call to <font face='courier'><a href='../../../predef_3A_3A/GSSAPI/Context/last_confidential.html'>last_confidential</a></font>  will tell if it is or not.</p>
</font></dd>
<dt><font face='Helvetica'>Parameter <tt><font color='#8000F0'>qop</font></tt></font><dt>
<dd></dd><dd><font face='Helvetica'><p>The quality of protection. This is a mechanism-specific value
   that lets the user direct how the underlying mechanism
   calculates the MIC. See RFC 2743, section 1.2.4.</p>
<p>   Zero or left out means use the default method.</p>
</font></dd>
<dt><font face='Helvetica'>Note</font><dt>
<dd><font face='Helvetica'><p>This function sets the value returned by <font face='courier'><a href='../../../predef_3A_3A/GSSAPI/Context/last_confidential.html'>last_confidential</a></font> .</p>
</font></dd>
<dt><font face='Helvetica'>See also</font><dt>
<dd><font face='Helvetica'><p><font face='courier'><a href='../../../predef_3A_3A/GSSAPI/Context/wrap_size_limit.html'>wrap_size_limit</a></font> </p>
</font></dd></dl>


    <hr size='1' noshade='1' />
    </td>
  </tr>
</table>
</body>
</html>